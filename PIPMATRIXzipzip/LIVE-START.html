<!DOCTYPE html>
<html lang="en" x-data="{ darkMode: localStorage.getItem('theme') === 'light' ? false : true }"
      :class="{ 'dark': darkMode }"
      class="dark bg-gray-900">
<head>
    <meta charset="UTF-8">
    <title>Live Trading - Pip Matrix</title>
    <meta http-equiv="content-type" content="text/html;charset=UTF-8">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="images/LOGO.jpeg" rel="icon" type="image/x-icon" />
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                    },
                    colors: {
                        primary: {
                            50: '#eef2ff',
                            100: '#e0e7ff',
                            200: '#c7d2fe',
                            300: '#a5b4fc',
                            400: '#818cf8',
                            500: '#6366f1',
                            600: '#4f46e5',
                            700: '#4338ca',
                            800: '#3730a3',
                            900: '#312e81',
                        },
                        'glass': 'rgba(255, 255, 255, 0.05)',
                    },
                    backdropBlur: {
                        'xs': '2px',
                    },
                    animation: {
                        'gradient-x': 'gradient-x 15s ease infinite',
                        'gradient-y': 'gradient-y 15s ease infinite',
                        'gradient-xy': 'gradient-xy 15s ease infinite',
                        'pulse-slow': 'pulse 4s cubic-bezier(0.4, 0, 0.6, 1) infinite',
                        'float': 'float 6s ease-in-out infinite',
                    },
                    keyframes: {
                        'gradient-y': {
                            '0%, 100%': {
                                'background-size': '400% 400%',
                                'background-position': 'center top'
                            },
                            '50%': {
                                'background-size': '200% 200%',
                                'background-position': 'center center'
                            }
                        },
                        'gradient-x': {
                            '0%, 100%': {
                                'background-size': '200% 200%',
                                'background-position': 'left center'
                            },
                            '50%': {
                                'background-size': '200% 200%',
                                'background-position': 'right center'
                            }
                        },
                        'gradient-xy': {
                            '0%, 100%': {
                                'background-size': '400% 400%',
                                'background-position': 'left center'
                            },
                            '50%': {
                                'background-size': '200% 200%',
                                'background-position': 'right center'
                            }
                        },
                        'float': {
                            '0%, 100%': { transform: 'translateY(0)' },
                            '50%': { transform: 'translateY(-10px)' }
                        }
                    }
                }
            }
        }
    </script>
    <script src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js" defer></script>
    <script>
        if (!localStorage.getItem('theme')) {
            localStorage.setItem('theme', 'dark');
            document.documentElement.classList.add('dark');
        }
        document.addEventListener('alpine:init', () => {
            Alpine.store('theme', {
                init() {
                    this.darkMode = localStorage.getItem('theme') === 'dark' || !localStorage.getItem('theme');
                    this.updateTheme();
                },
                darkMode: true,
                toggle() {
                    this.darkMode = !this.darkMode;
                    this.updateTheme();
                },
                updateTheme() {
                    localStorage.setItem('theme', this.darkMode ? 'dark' : 'light');
                    document.documentElement.classList.toggle('dark', this.darkMode);
                }
            });
        });
    </script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <script src="static/js/api.js"></script>
</head>
<body x-data="{ ...userData(), darkMode: localStorage.theme === 'dark' || !localStorage.theme, sidebarOpen: false, liveBalance: 0, openTrades: [], activeTrade: null }"
      x-init="init(); loadLiveBalance();"
      :class="{ 'dark': darkMode }"
      class="dark text-gray-100 bg-gray-900" x-cloak>
    <style>
        body { overflow-x: hidden; }
        [x-cloak] { display: none !important; }
    </style>

<nav x-data="{
  open: false,
  darkMode: localStorage.theme === 'dark' || !localStorage.theme,
  notificationOpen: false,
  quickActionsOpen: false
}"
     class="bg-white/98 dark:bg-gray-900/98 backdrop-blur-xl border-b border-gray-200/80 dark:border-gray-700/80 sticky top-0 z-50 shadow-sm dark:shadow-gray-900/20" x-cloak>

  <div class="max-w-7xl mx-auto px-6 lg:px-8">
    <div class="flex justify-between items-center h-20">
      <div class="flex items-center space-x-4">
        <a href="DASHBOARD.html" class="flex items-center space-x-3 group">
          <img src="images/LOGO.jpeg" class="h-10 sm:h-12 w-auto" alt="Logo" />
          <div class="hidden sm:block">
            <span class="text-lg font-bold text-gray-900 dark:text-white group-hover:text-blue-600 dark:group-hover:text-blue-400 transition-colors">
             Pip Matrix
            </span>
            <div class="text-xs text-gray-500 dark:text-gray-400 font-medium">
              Professional Trading
            </div>
          </div>
        </a>
        <div class="hidden lg:flex items-center space-x-4 ml-8 pl-8 border-l border-gray-200 dark:border-gray-700"
             x-data="cryptoPrices()" x-init="fetchPrices()">
          <div class="flex items-center space-x-2">
            <div class="w-2 h-2 bg-green-500 rounded-full animate-pulse"></div>
            <span class="text-xs font-medium text-gray-600 dark:text-gray-300">LIVE</span>
          </div>
          <div class="text-sm">
            <span class="text-gray-500 dark:text-gray-400">BTC:</span>
            <span class="font-mono ml-1"
                  :class="btcChange >= 0 ? 'text-green-600 dark:text-green-400' : 'text-red-600 dark:text-red-400'"
                  x-text="'$' + (btcPrice ? btcPrice.toLocaleString() : '...')"></span>
          </div>
          <div class="text-sm">
            <span class="text-gray-500 dark:text-gray-400">ETH:</span>
            <span class="font-mono ml-1"
                  :class="ethChange >= 0 ? 'text-green-600 dark:text-green-400' : 'text-red-600 dark:text-red-400'"
                  x-text="'$' + (ethPrice ? ethPrice.toLocaleString() : '...')"></span>
          </div>
        </div>
      </div>

      <div class="hidden md:flex items-center space-x-6">
        <div class="bg-gradient-to-r from-blue-50 to-indigo-50 dark:from-blue-900/20 dark:to-indigo-900/20 px-4 py-2 rounded-lg border border-blue-100 dark:border-blue-800">
          <div class="text-xs text-gray-500 dark:text-gray-400 uppercase tracking-wide">Live Balance</div>
          <div class="text-lg font-bold text-blue-600 dark:text-blue-400" x-text="'$' + liveBalance.toLocaleString(undefined, {minimumFractionDigits: 2, maximumFractionDigits: 2})">$0.00</div>
        </div>
      </div>

      <div class="flex items-center space-x-2">
        <button
          x-data="{ darkMode: localStorage.getItem('theme') === 'dark' }"
          @click="darkMode = !darkMode; localStorage.setItem('theme', darkMode ? 'dark' : 'light'); document.documentElement.classList.toggle('dark', darkMode)"
          class="p-2 text-gray-600 dark:text-gray-300 hover:text-blue-600 dark:hover:text-blue-400 hover:bg-gray-50 dark:hover:bg-gray-800 rounded-lg transition-all duration-200"
          :aria-pressed="darkMode">
          <i data-lucide="sun" x-show="!darkMode" class="w-5 h-5"></i>
          <i data-lucide="moon" x-show="darkMode" class="w-5 h-5"></i>
        </button>

        <div class="relative" x-data="{ dropdownOpen: false }">
          <button @click="dropdownOpen = !dropdownOpen"
                  class="flex items-center space-x-3 px-2 py-2 text-sm rounded-lg hover:bg-gray-50 dark:hover:bg-gray-800 transition-all duration-200 focus:outline-none">
            <div class="flex items-center space-x-2">
              <div class="w-8 h-8 rounded-full bg-gradient-to-r from-blue-500 to-indigo-600 flex items-center justify-center text-white text-sm font-medium" x-text="name ? name.charAt(0).toUpperCase() : 'U'">
                U
              </div>
              <div class="hidden sm:block text-left">
                <div class="text-sm font-medium text-gray-900 dark:text-white truncate max-w-[120px]" x-text="name || 'Trader'">
                  Trader
                </div>
                <div class="text-xs text-blue-500 dark:text-blue-400">
                  Live Account
                </div>
              </div>
            </div>
            <i data-lucide="chevron-down" class="w-4 h-4 text-gray-400" :class="dropdownOpen ? 'rotate-180' : ''"></i>
          </button>

          <div x-show="dropdownOpen" @click.away="dropdownOpen = false"
               x-transition:enter="transition ease-out duration-200"
               x-transition:enter-start="opacity-0 scale-95"
               x-transition:enter-end="opacity-100 scale-100"
               class="absolute right-0 mt-2 w-64 bg-white dark:bg-gray-800 rounded-lg shadow-lg border border-gray-200 dark:border-gray-700 z-20" x-cloak>
            <div class="p-4 border-b border-gray-200 dark:border-gray-700">
              <div class="flex items-center space-x-3">
                <div class="w-12 h-12 rounded-full bg-gradient-to-r from-blue-500 to-indigo-600 flex items-center justify-center text-white text-lg font-medium" x-text="name ? name.charAt(0).toUpperCase() : 'U'">
                  U
                </div>
                <div>
                  <div class="text-sm font-medium text-gray-900 dark:text-white" x-text="name || 'Trader'">
                    Trader
                  </div>
                  <div class="text-xs text-blue-500 dark:text-blue-400" x-text="'$' + liveBalance.toLocaleString(undefined, {minimumFractionDigits: 2, maximumFractionDigits: 2})">
                    $0.00
                  </div>
                </div>
              </div>
            </div>
            <div class="p-2">
              <a href="DASHBOARD.html" class="flex items-center px-3 py-2 text-sm text-gray-700 dark:text-gray-300 hover:bg-blue-50 dark:hover:bg-blue-900/20 rounded-md">
                <i data-lucide="layout-dashboard" class="w-4 h-4 mr-3"></i>
                Dashboard
              </a>
              <a href="DEMO.html" class="flex items-center px-3 py-2 text-sm text-gray-700 dark:text-gray-300 hover:bg-blue-50 dark:hover:bg-blue-900/20 rounded-md">
                <i data-lucide="graduation-cap" class="w-4 h-4 mr-3"></i>
                Demo Trading
              </a>
              <a href="PROFILE.html" class="flex items-center px-3 py-2 text-sm text-gray-700 dark:text-gray-300 hover:bg-blue-50 dark:hover:bg-blue-900/20 rounded-md">
                <i data-lucide="user" class="w-4 h-4 mr-3"></i>
                Profile Settings
              </a>
            </div>
          </div>
        </div>

        <button @click="sidebarOpen = !sidebarOpen"
                class="md:hidden p-2 text-gray-600 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-800 rounded-lg">
          <i data-lucide="menu" class="w-6 h-6"></i>
        </button>
      </div>
    </div>
  </div>
</nav>

<aside :class="sidebarOpen ? 'translate-x-0' : '-translate-x-full md:translate-x-0'"
       class="fixed left-0 top-[80px] bottom-0 w-64 bg-white dark:bg-gray-900 border-r border-gray-200 dark:border-gray-700 transform transition-transform duration-200 z-50 overflow-y-auto" x-cloak>
    <nav class="p-4 space-y-1">
        <div class="space-y-2">
            <div class="flex items-center gap-2 px-2 text-xs font-semibold text-gray-600 dark:text-gray-400 uppercase">
                <i data-lucide="candlestick-chart" class="w-4 h-4"></i>
                <span>Live Trading</span>
            </div>
            <ul class="space-y-1">
                <li>
                    <a href="DASHBOARD.html" class="group relative flex items-center px-3 py-2 text-gray-700 dark:text-gray-200 rounded-lg hover:bg-blue-50 dark:hover:bg-blue-900/50 transition-colors duration-150">
                        <i data-lucide="layout-dashboard" class="w-5 h-5 mr-3"></i>
                        Dashboard
                    </a>
                </li>
                <li>
                    <a href="LIVE-START.html" class="group relative flex items-center px-3 py-2 text-white bg-blue-600 rounded-lg transition-colors duration-150">
                        <i data-lucide="trending-up" class="w-5 h-5 mr-3"></i>
                        Start Live Trade
                        <span class="ml-auto flex items-center px-2 py-0.5 text-xs font-medium text-blue-100 bg-blue-700 rounded-full">
                            Real Money
                        </span>
                    </a>
                </li>
            </ul>
        </div>

        <div class="space-y-2">
            <div class="flex items-center gap-2 px-2 mt-6 text-xs font-semibold text-gray-600 dark:text-gray-400 uppercase">
                <i data-lucide="graduation-cap" class="w-4 h-4"></i>
                <span>Demo Trading</span>
            </div>
            <ul class="space-y-1">
                <li>
                    <a href="DEMO.html" class="flex items-center px-3 py-2 text-gray-700 dark:text-gray-200 rounded-lg hover:bg-blue-50 dark:hover:bg-blue-900/50 transition-colors duration-150">
                        <i data-lucide="play-circle" class="w-5 h-5 mr-3"></i>
                        Demo Dashboard
                    </a>
                </li>
                <li>
                    <a href="DEMO-START.html" class="flex items-center px-3 py-2 text-gray-700 dark:text-gray-200 rounded-lg hover:bg-blue-50 dark:hover:bg-blue-900/50 transition-colors duration-150">
                        <i data-lucide="test-tube" class="w-5 h-5 mr-3"></i>
                        Practice Trading
                    </a>
                </li>
            </ul>
        </div>

        <div class="space-y-2">
            <div class="flex items-center gap-2 px-2 mt-6 text-xs font-semibold text-gray-600 dark:text-gray-400 uppercase">
                <i data-lucide="wallet" class="w-4 h-4"></i>
                <span>Funds</span>
            </div>
            <ul class="space-y-1">
                <li>
                    <a href="DEPOSIT.html" class="flex items-center px-3 py-2 text-gray-700 dark:text-gray-200 rounded-lg hover:bg-blue-50 dark:hover:bg-blue-900/50 transition-colors duration-150">
                        <i data-lucide="plus-circle" class="w-5 h-5 mr-3"></i>
                        Deposit Funds
                    </a>
                </li>
                <li>
                    <a href="WITHDRAW.html" class="flex items-center px-3 py-2 text-gray-700 dark:text-gray-200 rounded-lg hover:bg-blue-50 dark:hover:bg-blue-900/50 transition-colors duration-150">
                        <i data-lucide="minus-circle" class="w-5 h-5 mr-3"></i>
                        Withdraw Funds
                    </a>
                </li>
            </ul>
        </div>

        <div class="mt-6 p-4 border-t border-gray-200 dark:border-gray-700">
            <a href="index.html" class="flex items-center w-full px-3 py-2 text-red-600 dark:text-red-400 rounded-lg hover:bg-red-50 dark:hover:bg-red-900/50 transition-colors duration-150">
                <i data-lucide="log-out" class="w-5 h-5 mr-3"></i>
                <span>Sign Out</span>
            </a>
        </div>
    </nav>
</aside>

<div x-show="sidebarOpen" @click="sidebarOpen = false" class="fixed inset-0 bg-black bg-opacity-50 z-40 md:hidden" x-cloak></div>

<div class="flex-1 ml-0 md:ml-64 p-4 pb-20 md:pb-4">
    <div class="bg-white dark:bg-gray-900 border-b border-gray-100 dark:border-gray-800" x-cloak>
        <div class="px-4 py-6 sm:py-8 mx-auto max-w-7xl sm:px-6 lg:px-8">
            <div class="flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4">
                <div class="text-center lg:text-left">
                    <h1 class="text-2xl sm:text-3xl font-bold text-gray-900 dark:text-white">
                        Live Trading
                    </h1>
                    <p class="mt-2 text-gray-600 dark:text-gray-400">
                        Trade with real money - Profits are yours to keep!
                    </p>
                </div>
                <div class="flex flex-col sm:flex-row gap-2 sm:gap-3">
                    <div class="inline-flex items-center justify-center gap-2 px-4 py-2 sm:py-3 bg-blue-100 dark:bg-blue-900/30 text-blue-700 dark:text-blue-300 rounded-lg text-sm sm:text-base">
                        <i data-lucide="wallet" class="w-4 h-4 sm:w-5 sm:h-5"></i>
                        Balance: <span x-text="'$' + liveBalance.toLocaleString(undefined, {minimumFractionDigits: 2, maximumFractionDigits: 2})">$0.00</span>
                    </div>
                    <a href="DASHBOARD.html" class="inline-flex items-center justify-center gap-2 px-4 py-2 sm:py-3 bg-gray-600 hover:bg-gray-700 text-white rounded-lg shadow transition-colors text-sm sm:text-base">
                        <i data-lucide="arrow-left" class="w-4 h-4 sm:w-5 sm:h-5"></i> Back to Dashboard
                    </a>
                </div>
            </div>
        </div>
    </div>

    <div class="px-4 py-6 sm:py-8 mx-auto max-w-7xl sm:px-6 lg:px-8">
        <div class="grid lg:grid-cols-3 gap-6">
            <div class="lg:col-span-2">
                <div class="bg-white dark:bg-gray-900 rounded-xl border border-gray-100 dark:border-gray-800 shadow-sm">
                    <div class="p-4 sm:p-6 border-b border-gray-100 dark:border-gray-800">
                        <div class="flex items-center justify-between">
                            <h2 class="text-lg font-semibold text-gray-900 dark:text-white">
                                Place Live Trade
                            </h2>
                            <div class="flex items-center gap-2 px-3 py-1 bg-blue-50 dark:bg-blue-900/20 rounded-full">
                                <i data-lucide="dollar-sign" class="w-4 h-4 text-blue-600 dark:text-blue-400"></i>
                                <span class="text-sm text-blue-600 dark:text-blue-400">Real Money</span>
                            </div>
                        </div>
                        <p class="text-sm text-gray-500 dark:text-gray-400 mt-1">
                            Select an asset and configure your live trade
                        </p>
                    </div>

                    <form id="liveTradeForm" class="p-4 sm:p-6 space-y-6" @submit.prevent="executeLiveTrade()">
                        <div class="space-y-2">
                            <label for="asset" class="block text-sm font-medium text-gray-700 dark:text-gray-300">
                                Select Asset <span class="text-red-500">*</span>
                            </label>
                            <select name="asset" id="asset" required
                                    class="block w-full px-3 py-3 bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700
                                           rounded-lg text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                                <option value="">Choose an asset to trade...</option>
                                <option value="BTC/USD" data-name="Bitcoin" data-type="crypto" data-price="87461.00">BTC/USD - Bitcoin ($87,461.00) [Crypto]</option>
                                <option value="ETH/USD" data-name="Ethereum" data-type="crypto" data-price="2895.97">ETH/USD - Ethereum ($2,895.97) [Crypto]</option>
                                <option value="USDT/USD" data-name="Tether" data-type="crypto" data-price="1.00">USDT/USD - Tether ($1.00) [Crypto]</option>
                                <option value="XRP/USD" data-name="XRP" data-type="crypto" data-price="2.20">XRP/USD - XRP ($2.20) [Crypto]</option>
                                <option value="SOL/USD" data-name="Solana" data-type="crypto" data-price="136.30">SOL/USD - Solana ($136.30) [Crypto]</option>
                                <option value="BNB/USD" data-name="BNB" data-type="crypto" data-price="852.43">BNB/USD - BNB ($852.43) [Crypto]</option>
                                <option value="DOGE/USD" data-name="Dogecoin" data-type="crypto" data-price="0.15">DOGE/USD - Dogecoin ($0.15) [Crypto]</option>
                                <option value="ADA/USD" data-name="Cardano" data-type="crypto" data-price="0.41">ADA/USD - Cardano ($0.41) [Crypto]</option>
                                <option value="LTC/USD" data-name="Litecoin" data-type="crypto" data-price="83.69">LTC/USD - Litecoin ($83.69) [Crypto]</option>
                                <option value="LINK/USD" data-name="Chainlink" data-type="crypto" data-price="12.79">LINK/USD - Chainlink ($12.79) [Crypto]</option>
                                <option value="DOT/USD" data-name="Polkadot" data-type="crypto" data-price="2.26">DOT/USD - Polkadot ($2.26) [Crypto]</option>
                                <option value="AVAX/USD" data-name="Avalanche" data-type="crypto" data-price="13.91">AVAX/USD - Avalanche ($13.91) [Crypto]</option>
                                <option value="AAPL" data-name="Apple Inc." data-type="stock" data-price="178.50">AAPL - Apple Inc. ($178.50) [Stock]</option>
                                <option value="GOOGL" data-name="Alphabet Inc." data-type="stock" data-price="142.30">GOOGL - Alphabet Inc. ($142.30) [Stock]</option>
                                <option value="MSFT" data-name="Microsoft Corp." data-type="stock" data-price="378.20">MSFT - Microsoft Corp. ($378.20) [Stock]</option>
                                <option value="TSLA" data-name="Tesla Inc." data-type="stock" data-price="245.60">TSLA - Tesla Inc. ($245.60) [Stock]</option>
                                <option value="AMZN" data-name="Amazon.com Inc." data-type="stock" data-price="185.40">AMZN - Amazon.com Inc. ($185.40) [Stock]</option>
                                <option value="NVDA" data-name="NVIDIA Corp." data-type="stock" data-price="875.30">NVDA - NVIDIA Corp. ($875.30) [Stock]</option>
                                <option value="EUR/USD" data-name="Euro/US Dollar" data-type="forex" data-price="1.0850">EUR/USD - Euro/US Dollar (1.0850) [Forex]</option>
                                <option value="GBP/USD" data-name="British Pound/US Dollar" data-type="forex" data-price="1.2650">GBP/USD - British Pound/US Dollar (1.2650) [Forex]</option>
                                <option value="USD/JPY" data-name="US Dollar/Japanese Yen" data-type="forex" data-price="149.50">USD/JPY - US Dollar/Japanese Yen (149.50) [Forex]</option>
                            </select>
                        </div>

                        <div class="grid sm:grid-cols-2 gap-6">
                            <div class="space-y-2">
                                <label for="amount" class="block text-sm font-medium text-gray-700 dark:text-gray-300">
                                    Trade Amount (USD) <span class="text-red-500">*</span>
                                </label>
                                <input type="number" name="amount" id="amount" required
                                       min="1" step="0.01" value="100"
                                       :max="liveBalance"
                                       class="block w-full px-3 py-3 bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700
                                              rounded-lg text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                                <p class="text-xs text-gray-500 dark:text-gray-400">Min: $1.00 | Max: Your balance</p>
                            </div>

                            <div class="space-y-2">
                                <label for="leverage" class="block text-sm font-medium text-gray-700 dark:text-gray-300">
                                    Leverage
                                </label>
                                <select name="leverage" id="leverage"
                                        class="block w-full px-3 py-3 bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700
                                               rounded-lg text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                                    <option value="1">1x (No Leverage)</option>
                                    <option value="2">2x</option>
                                    <option value="5">5x</option>
                                    <option value="10" selected>10x</option>
                                    <option value="25">25x</option>
                                    <option value="50">50x</option>
                                    <option value="100">100x</option>
                                </select>
                            </div>
                        </div>

                        <div class="space-y-3">
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300">
                                Order Type <span class="text-red-500">*</span>
                            </label>
                            <div class="grid grid-cols-2 gap-4">
                                <label class="relative flex items-center justify-center p-4 bg-green-50 dark:bg-green-900/20 border-2 border-green-500 rounded-lg cursor-pointer hover:bg-green-100 dark:hover:bg-green-900/30 transition-colors">
                                    <input type="radio" name="order_type" value="buy" checked class="sr-only">
                                    <div class="text-center">
                                        <i data-lucide="trending-up" class="w-6 h-6 mx-auto text-green-600 dark:text-green-400 mb-1"></i>
                                        <span class="block text-sm font-medium text-green-700 dark:text-green-300">Buy / Long</span>
                                        <span class="text-xs text-green-600 dark:text-green-400">Profit when price rises</span>
                                    </div>
                                </label>
                                <label class="relative flex items-center justify-center p-4 bg-gray-50 dark:bg-gray-800 border-2 border-gray-200 dark:border-gray-700 rounded-lg cursor-pointer hover:bg-red-50 dark:hover:bg-red-900/20 hover:border-red-300 dark:hover:border-red-700 transition-colors">
                                    <input type="radio" name="order_type" value="sell" class="sr-only">
                                    <div class="text-center">
                                        <i data-lucide="trending-down" class="w-6 h-6 mx-auto text-red-600 dark:text-red-400 mb-1"></i>
                                        <span class="block text-sm font-medium text-gray-700 dark:text-gray-300">Sell / Short</span>
                                        <span class="text-xs text-gray-500 dark:text-gray-400">Profit when price falls</span>
                                    </div>
                                </label>
                            </div>
                        </div>

                        <div class="pt-4">
                            <button type="submit"
                                    class="w-full bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-700 hover:to-indigo-700 text-white py-4 rounded-lg font-semibold transition-all duration-200 flex items-center justify-center gap-2 shadow-lg">
                                <i data-lucide="play" class="w-5 h-5"></i>
                                Execute Live Trade
                            </button>
                        </div>
                    </form>
                </div>
            </div>

            <div class="space-y-6">
                <div class="bg-white dark:bg-gray-900 rounded-xl border border-gray-100 dark:border-gray-800 shadow-sm">
                    <div class="p-4 sm:p-6 border-b border-gray-100 dark:border-gray-800">
                        <h3 class="text-lg font-semibold text-gray-900 dark:text-white">Trade Summary</h3>
                    </div>
                    <div class="p-4 sm:p-6 space-y-4">
                        <div class="flex justify-between items-center">
                            <span class="text-sm text-gray-500 dark:text-gray-400">Asset</span>
                            <span id="summary-asset" class="text-sm font-medium text-gray-900 dark:text-white">-</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-sm text-gray-500 dark:text-gray-400">Amount</span>
                            <span id="summary-amount" class="text-sm font-semibold text-gray-900 dark:text-white">$100.00</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-sm text-gray-500 dark:text-gray-400">Leverage</span>
                            <span id="summary-leverage" class="text-sm font-medium text-gray-900 dark:text-white">10x</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-sm text-gray-500 dark:text-gray-400">Position Size</span>
                            <span id="summary-position" class="text-sm font-bold text-blue-600 dark:text-blue-400">$1,000.00</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-sm text-gray-500 dark:text-gray-400">Max Risk</span>
                            <span id="summary-risk" class="text-sm font-medium text-red-600 dark:text-red-400">$100.00</span>
                        </div>
                    </div>
                </div>

                <div class="bg-white dark:bg-gray-900 rounded-xl border border-gray-100 dark:border-gray-800 shadow-sm">
                    <div class="p-4 sm:p-6 border-b border-gray-100 dark:border-gray-800">
                        <h3 class="text-lg font-semibold text-gray-900 dark:text-white">Account Info</h3>
                    </div>
                    <div class="p-4 sm:p-6">
                        <div class="space-y-4">
                            <div class="flex justify-between items-center">
                                <span class="text-sm text-gray-500 dark:text-gray-400">Available Balance</span>
                                <span class="text-sm font-semibold text-gray-900 dark:text-white" x-text="'$' + liveBalance.toLocaleString(undefined, {minimumFractionDigits: 2, maximumFractionDigits: 2})">$0.00</span>
                            </div>
                            <div class="flex justify-between items-center">
                                <span class="text-sm text-gray-500 dark:text-gray-400">Currency</span>
                                <span class="text-sm font-medium text-gray-900 dark:text-white">USD</span>
                            </div>
                            <div class="flex justify-between items-center">
                                <span class="text-sm text-gray-500 dark:text-gray-400">Trading Mode</span>
                                <span class="inline-flex items-center px-2 py-1 text-xs font-medium bg-blue-100 dark:bg-blue-900/30 text-blue-700 dark:text-blue-300 rounded-full">
                                    Live
                                </span>
                            </div>
                        </div>

                        <div class="mt-6 pt-4 border-t border-gray-100 dark:border-gray-800">
                            <a href="DEPOSIT.html" class="w-full bg-green-600 hover:bg-green-700 text-white py-2.5 rounded-lg text-sm font-medium transition-colors flex items-center justify-center gap-2">
                                <i data-lucide="plus-circle" class="w-4 h-4"></i>
                                Deposit Funds
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="fixed bottom-0 w-full z-30 md:hidden" x-data="{ fabOpen: false }" x-cloak>
  <div class="flex justify-between items-center bg-white/80 dark:bg-gray-900/80 backdrop-blur-lg px-6 py-4 shadow-[0_-8px_30px_rgba(0,0,0,0.12)] relative border-t border-gray-200/20 dark:border-gray-700/20">
    <a href="DASHBOARD.html" class="group flex flex-col items-center relative">
      <div class="p-2 rounded-xl transition-all duration-300 ease-out hover:bg-gray-100 dark:hover:bg-gray-800">
        <i data-lucide="layout-dashboard" class="w-6 h-6 text-gray-500 group-hover:text-blue-600 dark:text-gray-400 dark:group-hover:text-blue-400 transition-colors duration-300"></i>
      </div>
      <span class="text-xs font-medium mt-1 text-gray-500 group-hover:text-blue-600 dark:text-gray-400 dark:group-hover:text-blue-400 transition-colors duration-300">Home</span>
    </a>

    <a href="DEPOSIT.html" class="group flex flex-col items-center relative">
      <div class="p-2 rounded-xl transition-all duration-300 ease-out hover:bg-gray-100 dark:hover:bg-gray-800">
        <i data-lucide="banknote" class="w-6 h-6 text-gray-500 group-hover:text-blue-600 dark:text-gray-400 dark:group-hover:text-blue-400 transition-colors duration-300"></i>
      </div>
      <span class="text-xs font-medium mt-1 text-gray-500 group-hover:text-blue-600 dark:text-gray-400 dark:group-hover:text-blue-400 transition-colors duration-300">Deposit</span>
    </a>

    <button @click="fabOpen = !fabOpen"
            class="absolute -top-7 left-1/2 transform -translate-x-1/2
                   bg-gradient-to-r from-blue-600 to-indigo-600 text-white
                   w-14 h-14 rounded-full flex items-center justify-center
                   shadow-[0_8px_30px_rgba(59,130,246,0.5)]
                   border-4 border-white dark:border-gray-900
                   hover:scale-110 hover:shadow-[0_8px_35px_rgba(59,130,246,0.6)]
                   active:scale-95
                   transition-all duration-300 ease-out">
      <i data-lucide="zap" class="w-6 h-6 transform transition-transform group-hover:scale-110"></i>
      <span class="absolute w-full h-full rounded-full bg-blue-500 animate-ping opacity-20"></span>
    </button>

    <a href="SUPPORT.html" class="flex flex-col items-center text-gray-500 hover:text-blue-600">
      <i data-lucide="life-buoy" class="w-6 h-6"></i>
      <span class="text-xs mt-1">Support</span>
    </a>

    <a href="DEMO.html" class="flex flex-col items-center text-gray-500 hover:text-blue-600">
      <i data-lucide="graduation-cap" class="w-6 h-6 transition-colors duration-200"></i>
      <span class="text-xs mt-1">Demo</span>
    </a>
  </div>

  <div x-show="fabOpen" @click.away="fabOpen = false"
       class="fixed inset-0 bg-gray-900/70 backdrop-blur-sm z-40 flex items-center justify-center p-4"
       x-transition:enter="transition ease-out duration-300"
       x-transition:enter-start="opacity-0"
       x-transition:enter-end="opacity-100"
       x-transition:leave="transition ease-in duration-200"
       x-transition:leave-start="opacity-100"
       x-transition:leave-end="opacity-0" x-cloak>

    <div class="bg-gray-900 p-6 rounded-2xl shadow-[0_8px_30px_rgba(0,0,0,0.3)] space-y-4 w-72 max-w-full border border-gray-700 transform transition-all duration-300 animate-slideUp">
      <div class="grid grid-cols-2 gap-4 mb-6">
        <a href="CRYPTO.html" class="flex flex-col items-center p-4 rounded-xl bg-gray-800 border border-gray-700 hover:bg-gray-700 hover:shadow-lg hover:scale-105 transition-all duration-300 group">
          <i data-lucide="trending-up" class="w-6 h-6 mb-2 text-blue-400 group-hover:scale-110 transition-transform duration-300"></i>
          <span class="text-sm font-medium text-gray-200">Invest</span>
        </a>
        <a href="WITHDRAW.html" class="flex flex-col items-center p-4 rounded-xl bg-gray-800 border border-gray-700 hover:bg-gray-700 hover:shadow-lg hover:scale-105 transition-all duration-300 group">
          <i data-lucide="wallet" class="w-6 h-6 mb-2 text-green-400 group-hover:scale-110 transition-transform duration-300"></i>
          <span class="text-sm font-medium text-gray-200">Withdraw</span>
        </a>
      </div>

      <div class="space-y-2">
        <a href="DEMO.html" class="flex items-center p-3 rounded-lg text-gray-100 hover:bg-gray-800 transition-colors duration-200 group">
          <i data-lucide="graduation-cap" class="w-5 h-5 mr-3 text-green-400 group-hover:scale-110 transition-transform duration-300"></i>
          <span class="font-medium">Demo Trading</span>
          <span class="ml-auto text-xs font-bold text-green-400">Practice</span>
        </a>
        <a href="COPYTRADE.html" class="flex items-center p-3 rounded-lg text-gray-100 hover:bg-gray-800 transition-colors duration-200 group">
          <i data-lucide="copy" class="w-5 h-5 mr-3 text-blue-400 group-hover:scale-110 transition-transform duration-300"></i>
          <span class="font-medium">Copy Trading</span>
        </a>
        <a href="SUPPORT.html" class="flex items-center p-3 rounded-lg text-gray-100 hover:bg-gray-800 transition-colors duration-200 group">
          <i data-lucide="life-buoy" class="w-5 h-5 mr-3 text-cyan-400 group-hover:scale-110 transition-transform duration-300"></i>
          <span class="font-medium">Support</span>
        </a>
        <a href="BOTTRADE.html" class="flex items-center p-3 rounded-lg text-gray-100 hover:bg-gray-800 transition-colors duration-200 group">
          <i data-lucide="bot" class="w-5 h-5 mr-3 text-indigo-400 group-hover:scale-110 transition-transform duration-300"></i>
          <span class="font-medium">Bot Trading</span>
        </a>
      </div>

      <button @click="fabOpen = false" class="absolute top-2 right-2 p-2 rounded-full text-gray-400 hover:text-gray-200 hover:bg-gray-800 transition-colors duration-200">
        <i data-lucide="x" class="w-5 h-5"></i>
      </button>
    </div>
  </div>

  <style>
    @keyframes slideUp {
      from { opacity: 0; transform: scale(0.95) translateY(10px); }
      to { opacity: 1; transform: scale(1) translateY(0); }
    }
    .animate-slideUp { animation: slideUp 0.3s ease-out forwards; }
  </style>
</div>

<script src="https://unpkg.com/lucide@latest"></script>
<script>
    document.addEventListener('DOMContentLoaded', function() {
        lucide.createIcons();

        const assetSelect = document.getElementById('asset');
        const amountInput = document.getElementById('amount');
        const leverageSelect = document.getElementById('leverage');
        const orderTypeInputs = document.querySelectorAll('input[name="order_type"]');

        const summaryAsset = document.getElementById('summary-asset');
        const summaryAmount = document.getElementById('summary-amount');
        const summaryLeverage = document.getElementById('summary-leverage');
        const summaryPosition = document.getElementById('summary-position');
        const summaryRisk = document.getElementById('summary-risk');

        function updateSummary() {
            const selectedAsset = assetSelect.options[assetSelect.selectedIndex];
            summaryAsset.textContent = selectedAsset.value ? selectedAsset.dataset.name : '-';

            const amount = parseFloat(amountInput.value) || 0;
            summaryAmount.textContent = '$' + amount.toLocaleString(undefined, {minimumFractionDigits: 2, maximumFractionDigits: 2});

            const leverage = parseInt(leverageSelect.value) || 1;
            summaryLeverage.textContent = leverage + 'x';

            const positionSize = amount * leverage;
            summaryPosition.textContent = '$' + positionSize.toLocaleString(undefined, {minimumFractionDigits: 2, maximumFractionDigits: 2});

            summaryRisk.textContent = '$' + amount.toLocaleString(undefined, {minimumFractionDigits: 2, maximumFractionDigits: 2});
        }

        assetSelect.addEventListener('change', updateSummary);
        amountInput.addEventListener('input', updateSummary);
        leverageSelect.addEventListener('change', updateSummary);
        orderTypeInputs.forEach(input => {
            input.addEventListener('change', updateSummary);
        });

        updateSummary();

        const orderLabels = document.querySelectorAll('input[name="order_type"]');
        orderLabels.forEach(input => {
            input.addEventListener('change', function() {
                orderLabels.forEach(i => {
                    const label = i.closest('label');
                    if (i.checked) {
                        if (i.value === 'buy') {
                            label.classList.add('border-green-500', 'bg-green-50', 'dark:bg-green-900/20');
                            label.classList.remove('border-gray-200', 'dark:border-gray-700', 'bg-gray-50', 'dark:bg-gray-800');
                        } else {
                            label.classList.add('border-red-500', 'bg-red-50', 'dark:bg-red-900/20');
                            label.classList.remove('border-gray-200', 'dark:border-gray-700', 'bg-gray-50', 'dark:bg-gray-800');
                        }
                    } else {
                        label.classList.remove('border-green-500', 'border-red-500', 'bg-green-50', 'bg-red-50', 'dark:bg-green-900/20', 'dark:bg-red-900/20');
                        label.classList.add('border-gray-200', 'dark:border-gray-700', 'bg-gray-50', 'dark:bg-gray-800');
                    }
                });
            });
        });
    });

    async function loadLiveBalance() {
        try {
            const response = await fetch('/api/user/profile');
            const data = await response.json();
            if (data.success) {
                const alpineData = Alpine.$data(document.body);
                alpineData.liveBalance = data.account?.balance || data.user?.balance || 0;
            }
        } catch (error) {
            console.error('Error loading live balance:', error);
        }
    }

    async function executeLiveTrade() {
        const assetSelect = document.getElementById('asset');
        const asset = assetSelect.value;
        const selectedOption = assetSelect.options[assetSelect.selectedIndex];
        const entryPrice = parseFloat(selectedOption.dataset.price) || 0;
        const amount = parseFloat(document.getElementById('amount').value);
        const leverage = parseInt(document.getElementById('leverage').value);
        const orderType = document.querySelector('input[name="order_type"]:checked').value;
        const alpineData = Alpine.$data(document.body);

        if (!asset) {
            Swal.fire({
                icon: 'error',
                title: 'Asset Required',
                text: 'Please select an asset to trade.',
                confirmButtonColor: '#3B82F6'
            });
            return;
        }

        if (amount <= 0) {
            Swal.fire({
                icon: 'error',
                title: 'Invalid Amount',
                text: 'Please enter a valid trade amount.',
                confirmButtonColor: '#3B82F6'
            });
            return;
        }

        if (amount > alpineData.liveBalance) {
            Swal.fire({
                icon: 'error',
                title: 'Insufficient Balance',
                text: `You need $${amount.toLocaleString(undefined, {minimumFractionDigits: 2})} but only have $${alpineData.liveBalance.toLocaleString(undefined, {minimumFractionDigits: 2})} available. Please deposit more funds.`,
                confirmButtonColor: '#3B82F6',
                showCancelButton: true,
                cancelButtonText: 'Cancel',
                confirmButtonText: 'Deposit Funds'
            }).then((result) => {
                if (result.isConfirmed) {
                    window.location.href = 'DEPOSIT.html';
                }
            });
            return;
        }

        const confirmation = await Swal.fire({
            title: 'Confirm Live Trade',
            html: `
                <div class="text-left space-y-2">
                    <p><strong>Asset:</strong> ${selectedOption.dataset.name} (${asset})</p>
                    <p><strong>Order Type:</strong> ${orderType.toUpperCase()}</p>
                    <p><strong>Amount:</strong> $${amount.toLocaleString(undefined, {minimumFractionDigits: 2})}</p>
                    <p><strong>Leverage:</strong> ${leverage}x</p>
                    <p><strong>Position Size:</strong> $${(amount * leverage).toLocaleString(undefined, {minimumFractionDigits: 2})}</p>
                    <p class="text-red-600 font-semibold mt-4">This is a LIVE trade using real money!</p>
                </div>
            `,
            icon: 'warning',
            showCancelButton: true,
            confirmButtonColor: '#3B82F6',
            cancelButtonColor: '#6B7280',
            confirmButtonText: 'Execute Trade',
            cancelButtonText: 'Cancel'
        });

        if (!confirmation.isConfirmed) {
            return;
        }

        try {
            const response = await fetch('/api/trades', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({
                    symbol: asset,
                    trade_type: orderType,
                    amount: amount,
                    entry_price: entryPrice,
                    leverage: leverage,
                    is_demo: false
                })
            });

            const data = await response.json();

            if (data.success) {
                alpineData.liveBalance -= amount;

                Swal.fire({
                    icon: 'success',
                    title: 'Trade Executed!',
                    html: `
                        <div class="text-left">
                            <p>Your ${orderType.toUpperCase()} position on <strong>${selectedOption.dataset.name}</strong> has been opened.</p>
                            <p class="mt-2"><strong>Trade ID:</strong> #${data.trade_id}</p>
                            <p><strong>Amount:</strong> $${amount.toLocaleString(undefined, {minimumFractionDigits: 2})}</p>
                            <p><strong>Leverage:</strong> ${leverage}x</p>
                            <p><strong>New Balance:</strong> $${alpineData.liveBalance.toLocaleString(undefined, {minimumFractionDigits: 2})}</p>
                        </div>
                    `,
                    confirmButtonColor: '#3B82F6',
                    confirmButtonText: 'View Dashboard'
                }).then(() => {
                    window.location.href = 'DASHBOARD.html';
                });
            } else {
                Swal.fire({
                    icon: 'error',
                    title: 'Trade Failed',
                    text: data.message || 'Unable to execute trade. Please try again.',
                    confirmButtonColor: '#3B82F6'
                });
            }
        } catch (error) {
            console.error('Trade execution error:', error);
            Swal.fire({
                icon: 'error',
                title: 'Error',
                text: 'An error occurred while executing the trade. Please try again.',
                confirmButtonColor: '#3B82F6'
            });
        }
    }

    function cryptoPrices() {
        return {
            btcPrice: null,
            ethPrice: null,
            btcChange: 0,
            ethChange: 0,
            async fetchPrices() {
                try {
                    const response = await fetch('https://api.coingecko.com/api/v3/simple/price?ids=bitcoin,ethereum&vs_currencies=usd&include_24hr_change=true');
                    const data = await response.json();
                    this.btcPrice = Math.round(data.bitcoin.usd);
                    this.ethPrice = Math.round(data.ethereum.usd);
                    this.btcChange = data.bitcoin.usd_24h_change;
                    this.ethChange = data.ethereum.usd_24h_change;
                } catch (error) {
                    console.error('Error fetching crypto prices:', error);
                    this.btcPrice = 87461;
                    this.ethPrice = 2896;
                }
            }
        };
    }

    function userData() {
        return {
            name: '',
            email: '',
            async init() {
                try {
                    const response = await fetch('/api/user/profile');
                    const data = await response.json();
                    if (data.success) {
                        this.name = data.user?.full_name || data.user?.username || 'Trader';
                        this.email = data.user?.email || '';
                    }
                } catch (error) {
                    console.error('Error loading user data:', error);
                }
            }
        };
    }
</script>
</body>
</html>
